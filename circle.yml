dependencies:
  cache_directories:
    - vendor/

machine:
  php:
    version: 5.4.5

deployment:
  git:
    branch: dev
    commands:
      - make docs
      - git config user.name "Circle CI"
      - git config user.email "robot+circleci@gocardless.com"
      - git checkout gh-pages
      - rm -fr ./tests
      - rm -fr composer.json
      - rm -fr vendor
      - mv docs/api/* .
      - touch .nojekyll
      - git add .
      - git commit -m "[ci skip] Generate PHP Doc"
      - git push origin gh-pages
